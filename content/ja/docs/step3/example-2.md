---
title: ➁コードレビューの自動化
categories: [GitHub Copilot, Engineer Usecases]
weight: 2
---

コードレビューは、**チーム開発において欠かせないプロセス**です。しかしレビューは**手間がかかる**ため、**Copilot** を使って**自動化**することで**効率化**が期待できます。

---

## 1. レビューチェックシートを `#file` で読み込ませる

### 概要

- **Markdownファイル**に**チェックリスト**（レビュー項目）をまとめておく  
- **`#file review.md`** として Copilot に参照させ → 「このチェック項目に沿ってコードをレビューして」と依頼  
- Copilot はファイルに書かれた項目を読み取り、指摘やコメントを自動生成

#### 例: `review.md` (簡易チェックシート)

下記のような Java コードをレビューすることを想定します。

```java
public class BubbleSort {
    public static void sort(int[] arr){
        for(int i=0;i<arr.length;i++){
            for(int j=0;j<arr.length;j++){
                if(arr[i] > arr[j]){
                    int temp=arr[i];
                    arr[i]=arr[j];
                    arr[j]=temp;
                }
            }
        }
    }
    public static void main(String[] args){
        int[] data = {5, 1, 4, 2, 8};
        sort(data);
        for(int num : data){
            System.out.println(num);
        }
    }
}
```

- 以下のようなチェックリストを `review.md` に記述

```markdown
# Team Review Checklist

1. コードが予期せぬ動作をしないか確認する
2. 実装に創造的なアプローチが取り入れられているか評価する
3. コメントが将来のメンテナンスに役立つ情報を提供しているか確認する
```

---

### :pen: プロンプト例

```text
#file review.md に沿ってレビューコメントを作成してください
```

### :robot: 出力例 (イメージ)

Copilot が **「コードレビューコメント」**をまとめて提案します。

```
1. コードが予期せぬ動作をしないか確認する
現在のバブルソートの実装には問題があります。内側のループの条件が j < arr.length となっており、配列の全ての要素を比較していますが、これはバブルソートの正しい動作ではありません。正しいバブルソートでは、内側のループの条件は j < arr.length - i - 1 であるべきです。

2. 実装に創造的なアプローチが取り入れられているか評価する
この実装は標準的なバブルソートアルゴリズムに基づいています。特に創造的なアプローチは見られませんが、バブルソート自体はシンプルで理解しやすいアルゴリズムです。

3. コメントが将来のメンテナンスに役立つ情報を提供しているか確認する
現在のコードにはコメントがありません。将来のメンテナンスを考慮して、コードにコメントを追加することをお勧めします。
```

---

## 2. インラインチャットでレビューする

### 概要

- コードの一部を選択 → **右クリック → Copilot → "Review and Comment"** で**インラインチャット**を使ったレビューが可能  
- 大きなファイル全体をレビューする場合も、要所要所で選択しながら**部分レビュー**を行える

#### 操作手順

1. **レビューしたいコードブロック**をマウスで選択  
2. **右クリック → Copilot → "Review and Comment"**  
3. Copilot が**その範囲に関するコメント**や**疑問点**を提示 → 必要に応じて修正コードの提案も行う

---

## 3. カスタムインストラクションを設定すると常にチェックシートが適用

### 概要

- **カスタムインストラクション機能**（プレビュー中）を使って、**VS Codeのローカル設定**や **`.github/copilot-instructions.md`**に**レビュー項目**を記述  
- そうすると**チャットビューでもインラインチャット**でも、**いつでも**そのレビュー項目を意識した回答をCopilotが行う


---

## 練習

1. **新しいレビュー項目を追加**  
   - 例: 「エラー処理が適切か？」などを `review.md` に追記し、Copilotがレビューでどう指摘を変えるか観察  
2. **部分的レビュー vs 全体レビュー**  
   - 一部選択→レビュー、と**ファイル全体を指示→レビュー**を比べ、Copilot のコメントがどう違うかを見る  
3. **わざと項目から逸脱したコードを書く**  
   - Copilot が**「規約違反」「チェックリスト未対応」**と指摘できるかチェック

---

## まとめ

- **レビューチェックシート**を **`#file`** で読み込ませ、「このリストに沿ってレビューを」と頼む → Copilot が自動でコメント  
- **右クリック → Copilot → "Review and Comment"** で**インラインレビュー**が可能  
- **カスタムインストラクション**を設定すれば、**常に**チェックリストを参照したレビューを実行  
- チームのレビュー手順を共有し、Copilot に**初期段階で不備を発見**させることで、手作業のレビューが軽減

こうして**規約・チェックシート**をCopilotに積極的に使わせると、**レビュー効率**と**コード品質**が大幅に向上します。