---
title: ⑤ カスタムチャットモード
categories: [GitHub Copilot, Agent Mode]
weight: 5
---

## 1. カスタムチャットモードとは？

カスタムチャットモードは、特定の作業に最適化された**指示とツールの組み合わせ**を事前定義し、素早く切り替えられる機能です。例えば「計画立案モード」では実装プランの生成に特化し、読み取り専用ツールのみを使用するといった設定が可能です。

> **ポイント**
>
> * **専用設定** … 特定タスクに最適化されたツールと指示の組み合わせ
> * **素早い切り替え** … チャットモードドロップダウンから瞬時に変更
> * **再利用可能** … ワークスペースまたはユーザープロファイルに保存
> * **チーム共有** … `.chatmode.md` ファイルでチーム全体の標準化

---

## 2. カスタムチャットモードの活用シーン

| モード例 | 目的 | 含まれるツール | 指示内容 |
|----------|------|----------------|----------|
| **Plan** | 実装計画立案 | `codebase`, `search`, `usages` | コード編集せず、計画のみ生成 |
| **Review** | コードレビュー | `changes`, `problems`, `codebase` | セキュリティと品質に重点 |
| **Debug** | デバッグ支援 | `problems`, `runTests`, `terminalSelection` | エラー解析と修正提案 |
| **Document** | ドキュメント作成 | `codebase`, `fetch`, `githubRepo` | README、API仕様書生成 |

---

## 3. チャットモードファイルの構造

### 3.1 基本構造

チャットモードファイル（`.chatmode.md`）は以下の構造を持ちます：

```markdown
---
description: "モードの簡単な説明（チャット入力欄に表示）"
tools: ['tool1', 'tool2', 'toolset1']
model: "Claude Sonnet 4"
---

# モード固有の指示

ここにそのモードでの具体的な指示や
ガイドラインを記述します。
```

### 3.2 Front Matter の設定項目

| 項目 | 説明 | 例 |
|------|------|-----|
| `description` | モードの説明文 | `"実装計画を生成するモード"` |
| `tools` | 使用可能なツール・ツールセット | `['codebase', 'search', 'usages']` |
| `model` | 使用するAIモデル | `"Claude Sonnet 4"` |

---

## 4. 具体的なチャットモード例

### :pen: 例題

「計画立案モード」を作成してみましょう。

```markdown
---
description: "新機能やリファクタリングの実装計画を生成"
tools: ['codebase', 'fetch', 'findTestFiles', 'githubRepo', 'search', 'usages']
model: "Claude Sonnet 4"
---

# 計画立案モードの指示

あなたは計画立案モードです。新機能の実装やコードのリファクタリングの計画を生成することが主な役割です。

**重要**: コードの編集は行わず、計画のみを生成してください。

## 計画の構成

生成する計画は以下のセクションを含むMarkdown文書としてください：

* **概要**: 機能やリファクタリングタスクの簡潔な説明
* **要件**: 機能やリファクタリングの要件リスト
* **実装手順**: 詳細な実装ステップ
* **テスト**: 検証に必要なテストの一覧
* **リスク**: 想定される課題や注意点
```

### :robot: 出力例

計画立案モードを使用すると、Copilot は以下のような応答をします：

**ユーザー:** 「ユーザー認証機能を追加したい」

**Copilot応答:**
```markdown
# ユーザー認証機能 実装計画

## 概要
セキュアなユーザー認証システムを既存のWebアプリケーションに追加します。

## 要件
- JWT トークンベースの認証
- ログイン・ログアウト機能
- パスワード暗号化（bcrypt）
- セッション管理

## 実装手順
1. 認証ミドルウェアの作成
2. ユーザーモデルの設計
3. ログイン・ログアウトエンドポイント
4. フロントエンド認証フォーム
5. 保護されたルートの実装

## テスト
- 認証フローのユニットテスト
- APIエンドポイントの統合テスト
- セキュリティテスト

## リスク
- セッション管理の複雑性
- XSS/CSRF 攻撃への対策が必要
```

---

## 5. チャットモードの作成と管理

### 5.1 新規作成手順

1. **コマンドパレット** → `Chat: New Mode File`
![チャットモードの作成](../images/chat-create.png)
1. **保存場所を選択**:
   - **Workspace**: `.github/chatmodes/` フォルダ（チーム共有）
   - **User Profile**: 個人設定（複数ワークスペースで使用）
2. **モード名を入力** （チャットモードドロップダウンに表示される名前）
3. **ファイル内容を編集** （Front Matter + 指示内容）

### 5.2 既存モードの管理

**チャットビューから管理:**
1. **チャットビュー** → **設定ボタン** → **Modes**
2. **既存モードを選択** して編集
3. **アクション**: コピー・移動・名前変更・削除

**コマンドパレットから:**
- `Chat: Configure Chat Modes` → モード選択 → 編集

---

## 6. 実践的な活用パターン

### 6.1 プロジェクト固有モード

```markdown
---
description: "API開発専用モード"
tools: ['editFiles', 'runTests', 'fetch', 'problems']
---

# API開発モード

REST APIの開発に特化したモードです。

## 開発指針
- OpenAPI仕様に準拠
- エラーハンドリングを必須実装
- レスポンス形式を統一
- 適切なHTTPステータスコード使用
```

### 6.2 チーム標準モード

```bash
# プロジェクト構造例
.github/
└── chatmodes/
    ├── plan.chatmode.md      # 計画立案
    ├── review.chatmode.md    # コードレビュー
    ├── debug.chatmode.md     # デバッグ支援
    └── document.chatmode.md  # ドキュメント作成
```

---

## 7. 他のカスタマイズ手段との使い分け

ここでは「インストラクションファイル」「プロンプトファイル」「カスタムチャットモード」の3つに絞って役割を整理します。

| 手段 | 主目的 / 作用範囲 | 定義する内容 | 適用タイミング | ツール制御 | 主なユースケース |
|------|------------------|--------------|----------------|------------|------------------|
| **インストラクションファイル** (`*.instructions.md`) | プロジェクト/組織全体の恒常的背景 | 行動原則 / スタイル / レビュー観点 | すべての発話に常時マージ | 不可 | コーディング規約注入 / 品質観点共有 |
| **プロンプトファイル** (`*.prompt.md`) | 再利用したい具体的要求の雛形 | 質問テンプレ / ドキュメント骨子 | 必要時に手動挿入 | 不可 | 定型ドキュメント生成 / 繰り返し質問 |
| **カスタムチャットモード** (`*.chatmode.md`) | タスク特化の作業コンテキスト | 指示本文 + 利用可能ツール集合 (+任意でモデル) | モード選択時 | 可能 (`tools` 指定) | 計画立案 / レビュー / リサーチ / ドキュメント作成 |

### 7.1 使い分けの指針（最短まとめ）

| 判断の観点 | 最適 | 説明 |
|-------------|------|------|
| 常に効かせたい原則か | インストラクション | 全モードで自動適用したい長期ルール |
| その場で一回きり/数回貼るだけか | プロンプト | 都度プロンプトとして貼るだけで十分 |
| 指示とツール構成を一括で再現したいか | モード | 選択だけで環境と指示を切替えたい場合 |

### 7.2 カスタムチャットモードを選ぶチェックリスト

以下で 2 つ以上 YES ならモード化を検討:

- 複数回/複数人が同じタスクフローを繰り返す
- 特定のツール群だけを安全に限定したい
- 応答スタイル（観点/出力フォーマット）の一貫性が重要
- タスク開始時に毎回長い指示を貼る手間を減らしたい

### 7.3 代表パターン

| 目的 | 推奨構成 | 補足 |
|------|----------|------|
| 新機能の実装計画 | Plan モード + インストラクション | 背景原則はインストラクション、手順生成はモード |
| セキュリティレビュー | Review モード + セキュリティ観点インストラクション | モードでツールを `changes`/`codebase` 等に限定 |
| 調査 (リサーチ) | Research モード | 読み取り系ツールのみ指定で安全性確保 |
| 定型レポート生成 | プロンプト + インストラクション | モード不要、テンプレ貼付で十分 |
| 規約の全体浸透 | インストラクション | モード依存させない |

### 7.4 最低限の判断フロー

1. それは長期普遍の原則か → はい: インストラクション
2. 単発/散発利用のテンプレか → はい: プロンプト
3. 指示 + ツール制限をワンタップで再現したいか → はい: カスタムチャットモード
4. それ以外: 状況により最も近いものを選択

> 補足: カスタムチャットモードは「恒常的背景(インストラクション)」と「一回限りの具体要求(プロンプト)」を橋渡しする中間レイヤーです。

---

## 8. :memo: 練習

1. **基本モード**: 自分の作業スタイルに合った基本的なチャットモードを作成してください
2. **専門モード**: 特定の技術スタック（React、Node.js等）に特化したモードを作成してください
3. **チームモード**: プロジェクトチーム向けの標準的なモードを設計してください

---

## 9. まとめ

* **カスタムチャットモード** で特定タスクに最適化された環境を瞬時に構築
* **`.chatmode.md`** ファイルで指示とツールの組み合わせを定義
* **チーム共有** でプロジェクト全体の作業効率を向上
* **段階的活用** で徐々にモードを拡充し、開発ワークフローを最適化
